# frozen_string_literal: true

module <%= @root_namespace %>
  module Image
<%- if class_name.include?("::") -%>
<%- class_name.split("::")[0..-2].each_with_index do |mod, i| -%>
<%= "  " * (i + 2) %>module <%= mod %>
<%- end -%>
<%= "  " * (class_name.split("::").length + 1) %>class <%= class_name.split("::").last %>Transformer < ApplicationImageTransformer
<%- else -%>
    class <%= class_name %>Transformer < ApplicationImageTransformer
<%- end -%>
      # Model configuration
      model "<%= options[:model] %>"
      size "<%= options[:size] %>"
      strength <%= options[:strength] %>
<% if options[:content_policy] != "standard" -%>
      content_policy :<%= options[:content_policy] %>
<% end -%>
<% if options[:template] -%>

      # Prompt template
      template "<%= options[:template] %>"
<% end -%>
<% if options[:cache] -%>

      # Caching
      cache_for <%= options[:cache] %>
<% end -%>

      # Optional: Negative prompts
      # negative_prompt "blurry, low quality, distorted"

      # Optional: Description
      # description "Transforms images into <%= class_name.downcase %> style"
<%- if class_name.include?("::") -%>
<%- (class_name.split("::").length + 1).times do |i| -%>
<%= "  " * (class_name.split("::").length + 1 - i) %>end
<%- end -%>
<%- else -%>
    end
<%- end -%>
  end
end
