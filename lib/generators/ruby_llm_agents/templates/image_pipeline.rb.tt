# frozen_string_literal: true

# <%= class_name %>Pipeline - <%= options[:description] || "Image processing pipeline" %>
#
# Chains multiple image operations into a single workflow.
#
# Usage:
#   result = <%= class_name %>Pipeline.call(prompt: "Your prompt here")
#   result.final_image   # => The processed image
#   result.total_cost    # => Combined cost of all steps
#
class <%= class_name %>Pipeline < ApplicationImagePipeline
<%- parsed_steps.each do |step| -%>
<%- case step -%>
<%- when :generate -%>
  step :<%= step %>, generator: <%= class_name %>Generator
<%- when :upscale -%>
  step :<%= step %>, upscaler: <%= class_name %>Upscaler
<%- when :transform -%>
  step :<%= step %>, transformer: <%= class_name %>Transformer
<%- when :analyze -%>
  step :<%= step %>, analyzer: <%= class_name %>Analyzer
<%- when :remove_background -%>
  step :<%= step %>, remover: <%= class_name %>BackgroundRemover
<%- else -%>
  # step :<%= step %>, ...: <%= class_name %><%= step.to_s.camelize %>
<%- end -%>
<%- end -%>

<%- if options[:stop_on_error] == false -%>
  stop_on_error false
<%- end -%>
<%- if options[:cache].present? -%>
  cache_for <%= options[:cache] %>
<%- end -%>

  description "<%= class_name %> image processing pipeline"
  version "1.0"
end
