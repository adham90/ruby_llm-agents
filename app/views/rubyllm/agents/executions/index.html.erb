<h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6">Executions</h2>

<%= turbo_frame_tag "executions_content" do %>
  <%= render partial: "rubyllm/agents/executions/filters", locals: { agent_types: @agent_types, model_ids: @model_ids, filter_stats: @filter_stats } %>
  <%= render partial: "rubyllm/agents/executions/list", locals: { executions: @executions, pagination: @pagination, filter_stats: @filter_stats } %>
<% end %>

<script>
  // Toggle attempts expansion (used by executions list)
  function toggleAttempts(executionId) {
    const attemptsRow = document.getElementById('attempts-row-' + executionId);
    const expandBtn = document.querySelector(`button[data-execution-id="${executionId}"]`);

    if (attemptsRow) {
      const isHidden = attemptsRow.classList.contains('hidden');
      attemptsRow.classList.toggle('hidden');

      // Rotate the chevron
      if (expandBtn) {
        const svg = expandBtn.querySelector('svg');
        if (svg) {
          svg.classList.toggle('rotate-90', isHidden);
        }
        expandBtn.setAttribute('aria-expanded', isHidden ? 'true' : 'false');
      }
    }
  }
</script>
